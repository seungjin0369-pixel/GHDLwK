<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Mini Mario</title>
<style>
body {
  margin: 0;
  overflow: hidden;
  background: #5c94fc;
  font-family: sans-serif;
}
#gameArea {
  position: relative;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  background: #5c94fc;
}
.mario {
  position: absolute;
  width: 50px;
  height: 50px;
  background: red;
  bottom: 50px;
  left: 50px;
  border-radius: 5px;
}
.platform {
  position: absolute;
  width: 120px;
  height: 20px;
  background: #8B4513;
  border-radius: 5px;
}
.coin {
  position: absolute;
  width: 20px;
  height: 20px;
  background: gold;
  border-radius: 50%;
}
#score {
  position: absolute;
  top: 10px;
  left: 10px;
  font-size: 24px;
  color: white;
}
#gameOver {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 48px;
  color: red;
  display: none;
}
</style>
</head>
<body>
<div id="gameArea">
  <div class="mario" id="mario"></div>
  <div id="score">코인: 0</div>
  <div id="gameOver">게임 오버!</div>
</div>

<script>
const mario = document.getElementById("mario");
const gameArea = document.getElementById("gameArea");
const scoreEl = document.getElementById("score");
const gameOverEl = document.getElementById("gameOver");

let x = 50;
let y = 50;
let vy = 0;
const gravity = -1.2;
let jumping = false;
let score = 0;

const marioWidth = 50;
const marioHeight = 50;

const platforms = [];
const coins = [];

// 기본 발판
function createPlatform(x, y){
  const p = document.createElement("div");
  p.classList.add("platform");
  p.style.left = x + "px";
  p.style.bottom = y + "px";
  gameArea.appendChild(p);
  platforms.push(p);
}

// 기본 코인
function createCoin(x, y){
  const c = document.createElement("div");
  c.classList.add("coin");
  c.style.left = x + "px";
  c.style.bottom = y + "px";
  gameArea.appendChild(c);
  coins.push(c);
}

// 레벨 구성
createPlatform(0, 0);
createPlatform(150, 100);
createPlatform(300, 200);
createPlatform(450, 300);
createPlatform(600, 400);

createCoin(180, 130);
createCoin(330, 230);
createCoin(480, 330);

// 키 입력
const keys = {};
document.addEventListener("keydown", e=>{
  keys[e.key] = true;
});
document.addEventListener("keyup", e=>{
  keys[e.key] = false;
});

function update(){
  // 좌우 이동
  if(keys["ArrowRight"] || keys["d"]) x += 5;
  if(keys["ArrowLeft"] || keys["a"]) x -= 5;

  // 점프
  if((keys["ArrowUp"] || keys["w"] || keys[" "]) && !jumping){
    vy = 20;
    jumping = true;
  }

  // 중력
  vy += gravity;
  y += vy;

  // 발판 충돌
  let onPlatform = false;
  platforms.forEach(p=>{
    const px = p.offsetLeft;
    const pw = p.offsetWidth;
    const py = p.offsetTop;
    const ph = p.offsetHeight;

    if(x + marioWidth > px && x < px + pw &&
       y <= py + ph && y + marioHeight >= py &&
       vy <= 0){
      y = py + ph;
      vy = 0;
      jumping = false;
      onPlatform = true;
    }
  });

  // 코인 수집
  coins.forEach((c,i)=>{
    const cx = c.offsetLeft;
    const cy = c.offsetTop;
    if(x + marioWidth > cx && x < cx + 20 &&
       y + marioHeight > cy && y < cy + 20){
      score += 1;
      scoreEl.textContent = "코인: " + score;
      c.remove();
      coins.splice(i,1);
    }
  });

  // 화면 밖 방지
  if(x < 0) x = 0;
  if(x > window.innerWidth - marioWidth) x = window.innerWidth - marioWidth;

  // 게임 오버
  if(y < 0){
    gameOverEl.style.display = "block";
    return;
  }

  mario.style.left = x + "px";
  mario.style.bottom = y + "px";

  requestAnimationFrame(update);
}

update();
</script>
</body>
</html>
