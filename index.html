<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Mini Mario Enhanced</title>
<style>
body {
  margin: 0;
  overflow: hidden;
  background: linear-gradient(#5c94fc, #a0d8f1);
  font-family: sans-serif;
}
#gameArea {
  position: relative;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
}
.mario {
  position: absolute;
  width: 50px;
  height: 50px;
  background: red;
  bottom: 50px;
  left: 100px;
  border-radius: 5px;
}
.platform {
  position: absolute;
  width: 120px;
  height: 20px;
  background: #8B4513;
  border-radius: 5px;
}
.coin {
  position: absolute;
  width: 20px;
  height: 20px;
  background: gold;
  border-radius: 50%;
}
.enemy {
  position: absolute;
  width: 40px;
  height: 40px;
  background: green;
  border-radius: 5px;
}
#score {
  position: absolute;
  top: 10px;
  left: 10px;
  font-size: 24px;
  color: white;
}
#gameOver {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 48px;
  color: red;
  display: none;
}
#win {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 48px;
  color: yellow;
  display: none;
}
</style>
</head>
<body>
<div id="gameArea">
  <div class="mario" id="mario"></div>
  <div id="score">ÏΩîÏù∏: 0</div>
  <div id="gameOver">Í≤åÏûÑ Ïò§Î≤Ñ!</div>
  <div id="win">ÌÅ¥Î¶¨Ïñ¥! üéâ</div>
</div>

<audio id="jumpSound">
  <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_8c1aa0d9a3.mp3?filename=jump-6184.mp3" type="audio/mp3">
</audio>
<audio id="coinSound">
  <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_9e6bfbf169.mp3?filename=coin-6340.mp3" type="audio/mp3">
</audio>

<script>
const mario = document.getElementById("mario");
const gameArea = document.getElementById("gameArea");
const scoreEl = document.getElementById("score");
const gameOverEl = document.getElementById("gameOver");
const winEl = document.getElementById("win");
const jumpSound = document.getElementById("jumpSound");
const coinSound = document.getElementById("coinSound");

let x = 100;
let y = 50;
let vy = 0;
const gravity = -1.2;
let jumping = false;
let score = 0;

const marioWidth = 50;
const marioHeight = 50;

const platforms = [];
const coins = [];
const enemies = [];
let goalX = 1500; // Î™©Ìëú ÏßÄÏ†ê

// Î†àÎ≤® Íµ¨ÏÑ±
function createPlatform(x, y){
  const p = document.createElement("div");
  p.classList.add("platform");
  p.style.left = x + "px";
  p.style.bottom = y + "px";
  gameArea.appendChild(p);
  platforms.push(p);
}

function createCoin(x, y){
  const c = document.createElement("div");
  c.classList.add("coin");
  c.style.left = x + "px";
  c.style.bottom = y + "px";
  gameArea.appendChild(c);
  coins.push(c);
}

function createEnemy(x, y){
  const e = document.createElement("div");
  e.classList.add("enemy");
  e.style.left = x + "px";
  e.style.bottom = y + "px";
  gameArea.appendChild(e);
  enemies.push(e);
}

// ÌîåÎû´Ìèº
createPlatform(0, 0);
createPlatform(150, 100);
createPlatform(300, 200);
createPlatform(500, 250);
createPlatform(700, 300);
createPlatform(900, 200);
createPlatform(1100, 300);
createPlatform(1300, 350);

// ÏΩîÏù∏
createCoin(180, 130);
createCoin(330, 230);
createCoin(520, 280);
createCoin(910, 230);
createCoin(1310, 380);

// Ï†Å
createEnemy(400, 20);
createEnemy(1000, 20);
createEnemy(1200, 20);

// ÌÇ§ ÏûÖÎ†•
const keys = {};
document.addEventListener("keydown", e=>{ keys[e.key] = true; });
document.addEventListener("keyup", e=>{ keys[e.key] = false; });

function update(){
  // Ï¢åÏö∞ Ïù¥Îèô
  if(keys["ArrowRight"] || keys["d"]) x += 5;
  if(keys["ArrowLeft"] || keys["a"]) x -= 5;

  // Ï†êÌîÑ
  if((keys["ArrowUp"] || keys["w"] || keys[" "]) && !jumping){
    vy = 20;
    jumping = true;
    jumpSound.currentTime = 0;
    jumpSound.play();
  }

  // Ï§ëÎ†•
  vy += gravity;
  y += vy;

  // Î∞úÌåê Ï∂©Îèå
  let onPlatform = false;
  platforms.forEach(p=>{
    const px = p.offsetLeft;
    const pw = p.offsetWidth;
    const py = p.offsetTop;
    const ph = p.offsetHeight;

    if(x + marioWidth > px && x < px + pw &&
       y <= py + ph && y + marioHeight >= py &&
       vy <= 0){
      y = py + ph;
      vy = 0;
      jumping = false;
      onPlatform = true;
    }
  });

  // ÏΩîÏù∏ ÏàòÏßë
  coins.forEach((c,i)=>{
    const cx = c.offsetLeft;
    const cy = c.offsetTop;
    if(x + marioWidth > cx && x < cx + 20 &&
       y + marioHeight > cy && y < cy + 20){
      score += 1;
      scoreEl.textContent = "ÏΩîÏù∏: " + score;
      coinSound.currentTime = 0;
      coinSound.play();
      c.remove();
      coins.splice(i,1);
    }
  });

  // Ï†ÅÍ≥º Ï∂©Îèå
  enemies.forEach(e=>{
    const ex = e.offsetLeft;
    const ey = e.offsetTop;
    if(x + marioWidth > ex && x < ex + 40 &&
       y + marioHeight > ey && y < ey + 40){
      gameOverEl.style.display = "block";
      return;
    }
  });

  // Î™©Ìëú ÏßÄÏ†ê ÎèÑÎã¨
  if(x >= goalX){
    winEl.style.display = "block";
    return;
  }

  // ÌôîÎ©¥ Ïä§ÌÅ¨Î°§
  if(x > window.innerWidth/2){
    const delta = x - window.innerWidth/2;
    x = window.innerWidth/2;
    [...platforms, ...coins, ...enemies].forEach(el=>{
      const left = parseFloat(el.style.left);
      el.style.left = (left - delta) + "px";
    });
  }

  // ÌôîÎ©¥ Î∞ñ Î∞©ÏßÄ
  if(x < 0) x = 0;
  if(y < 0){
    gameOverEl.style.display = "block";
    return;
  }

  mario.style.left = x + "px";
  mario.style.bottom = y + "px";

  requestAnimationFrame(update);
}

update();
</script>
</body>
</html>
